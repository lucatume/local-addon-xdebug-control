'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = formatCmd;

var _path = require('path');

var _fsFindRoot = require('fs-find-root');

var _fsFindRoot2 = _interopRequireDefault(_fsFindRoot);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function formatCmd(cmd, fullFilepath) {
  var filepath = fullFilepath.replace(process.cwd() + '/', '');
  var filedir = (0, _path.dirname)(filepath);
  var fullFiledir = (0, _path.dirname)(fullFilepath);
  var filename = (0, _path.basename)(filepath);
  var values = {
    filedir: filedir,
    filename: filename,
    filepath: filepath,
    s: filepath,
    'full-filedir': fullFiledir,
    'full-filepath': fullFilepath
  };

  // chances are we don't always have to look up package.json folder, but
  // performance hit of this is probably so insignificant, it's not worth
  // the time to optimize this... PRs welcome of course :)
  return _fsFindRoot2.default.file('package.json', fullFiledir).then(function (rootDir) {
    return values['package-json-dir'] = (0, _path.dirname)(rootDir);
  }).then(function () {
    var keys = Object.keys(values).join('|');
    var results = cmd.replace(new RegExp('%(' + keys + ')', 'g'), function (match, key) {
      return values[key];
    });
    return results;
  });
}
//# sourceMappingURL=format-cmd.js.map